<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guia Interativo para Escrever Seu Livro</title>
    <style>
        /* Estilos CSS para as Abas (Mantidos do Exemplo Anterior) */
        body { font-family: sans-serif; }
        header { text-align: center; margin-bottom: 30px; }
        h1 { color: #333; }

        .tab-container {
            width: 90%;
            max-width: 1000px;
            margin: 20px auto;
            border: 1px solid #ccc;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .tab-buttons {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #ddd;
        }

        .tab-button {
            background-color: #f1f1f1;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            transition: 0.3s;
            font-size: 17px;
            border-radius: 8px 8px 0 0;
            margin-right: 5px;
            font-weight: bold;
        }

        .tab-button:hover {
            background-color: #ddd;
        }

        .tab-button.active {
            background-color: #fff;
            border-bottom: 2px solid #4CAF50;
            color: #4CAF50;
        }

        .tab-content {
            display: none;
            padding: 6px 12px;
            border-top: none;
        }

        /* Estilos para o Checklist e Fichas */
        .checklist-item, .personagem-ficha {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
            border-left: 5px solid #4CAF50;
        }
        .checklist-item label {
            margin-left: 5px;
        }

        .personagem-ficha label {
            display: block;
            margin-top: 10px;
            font-weight: bold;
        }
        .personagem-ficha input[type="text"], .personagem-ficha textarea {
            width: 98%;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            resize: vertical;
        }
        .remove-btn {
            float: right;
            background: #f44336;
            color: white;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 3px;
        }
    </style>
</head>
<body onload="carregarDados()"> <header>
        <h1>Guia Interativo para Escrever Seu Livro</h1>
        <p>Uma ferramenta para navegar pelas etapas da concep√ß√£o √† publica√ß√£o, agora com recursos interativos!</p>
    </header>

    <div class="tab-container">
        
        <div class="tab-buttons">
            <button class="tab-button active" onclick="openTab(event, 'Guias')">üìö Guias e Fases</button>
            <button class="tab-button" onclick="openTab(event, 'ChecklistCapitulos')">üìù Checklist de Cap√≠tulos</button>
            <button class="tab-button" onclick="openTab(event, 'FichaPersonagens')">üé≠ Ficha de Personagens</button>
        </div>

        <div id="Guias" class="tab-content" style="display: block;">
            <h2>Vis√£o Geral das Fases</h2>
            <p>Este √© o conte√∫do principal do seu guia. **(Insira o conte√∫do do seu site original aqui)**</p>
        </div>

        <div id="ChecklistCapitulos" class="tab-content">
            <h2>üìù Acompanhamento de Cap√≠tulos</h2>
            <p>Use esta se√ß√£o para acompanhar o progresso de cada cap√≠tulo da sua obra. Marque o que j√° est√° completo. **O progresso √© salvo automaticamente.**</p>
            
            <div id="capitulos-list">
                </div>
            
            <button onclick="adicionarCapitulo()">+ Adicionar Novo Cap√≠tulo</button>
        </div>

        <div id="FichaPersonagens" class="tab-content">
            <h2>üé≠ Fichas de Personagens</h2>
            <p>Crie e organize as fichas detalhadas para seus personagens principais. **O conte√∫do √© salvo automaticamente.**</p>
            
            <div id="personagens-list">
                </div>

            <button onclick="adicionarPersonagem()">+ Adicionar Novo Personagem</button>
        </div>

    </div>

    <script>
        // --- VARI√ÅVEIS GLOBAIS ---
        let capitulos = [];
        let personagens = [];

        // --- FUN√á√ïES DE PERSIST√äNCIA (SALVAR/CARREGAR) ---

        function salvarDados() {
            localStorage.setItem('guiaLivros_capitulos', JSON.stringify(capitulos));
            localStorage.setItem('guiaLivros_personagens', JSON.stringify(personagens));
            console.log('Dados Salvos!');
        }

        function carregarDados() {
            // Carregar Cap√≠tulos
            const dadosCapitulos = localStorage.getItem('guiaLivros_capitulos');
            if (dadosCapitulos) {
                capitulos = JSON.parse(dadosCapitulos);
                renderizarCapitulos();
            } else {
                // Se n√£o houver dados, adicione um exemplo inicial
                capitulos = [
                    { id: Date.now(), titulo: 'Cap√≠tulo 1: O Despertar', etapas: { escrito: false, revisado: false } }
                ];
                renderizarCapitulos();
            }

            // Carregar Personagens
            const dadosPersonagens = localStorage.getItem('guiaLivros_personagens');
            if (dadosPersonagens) {
                personagens = JSON.parse(dadosPersonagens);
                renderizarPersonagens();
            } else {
                personagens = [
                    { id: Date.now() + 1, nome: 'Ariane', motivacao: 'Buscar a verdade.', arco: 'De c√©tica a l√≠der.' }
                ];
                renderizarPersonagens();
            }
        }

        // --- FUN√á√ïES DE RENDERIZA√á√ÉO E MANIPULA√á√ÉO DE CAP√çTULOS ---

        function renderizarCapitulos() {
            const list = document.getElementById('capitulos-list');
            list.innerHTML = ''; // Limpa a lista antes de renderizar

            capitulos.forEach(cap => {
                const novoCap = document.createElement('div');
                novoCap.className = 'checklist-item';
                novoCap.id = `cap-${cap.id}`;
                
                novoCap.innerHTML = `
                    <h3>${cap.titulo} <button class="remove-btn" onclick="removerItem(${cap.id}, 'capitulos')">X</button></h3>
                    
                    <input type="checkbox" id="cap-${cap.id}-escrito" ${cap.etapas.escrito ? 'checked' : ''} onchange="atualizarCapitulo(${cap.id}, 'escrito', this.checked)">
                    <label for="cap-${cap.id}-escrito">Rascunho Escrito</label><br>
                    
                    <input type="checkbox" id="cap-${cap.id}-revisado" ${cap.etapas.revisado ? 'checked' : ''} onchange="atualizarCapitulo(${cap.id}, 'revisado', this.checked)">
                    <label for="cap-${cap.id}-revisado">Revis√£o Conclu√≠da</label>
                `;
                list.appendChild(novoCap);
            });
        }

        function adicionarCapitulo() {
            const numCap = capitulos.length + 1;
            const novoCap = { 
                id: Date.now(), 
                titulo: `Cap√≠tulo ${numCap}: Novo T√≠tulo`, 
                etapas: { escrito: false, revisado: false } 
            };
            capitulos.push(novoCap);
            renderizarCapitulos();
            salvarDados();
        }

        function atualizarCapitulo(id, etapa, valor) {
            const capIndex = capitulos.findIndex(c => c.id === id);
            if (capIndex !== -1) {
                capitulos[capIndex].etapas[etapa] = valor;
                salvarDados();
            }
        }

        // --- FUN√á√ïES DE RENDERIZA√á√ÉO E MANIPULA√á√ÉO DE PERSONAGENS ---

        function renderizarPersonagens() {
            const list = document.getElementById('personagens-list');
            list.innerHTML = ''; // Limpa a lista antes de renderizar

            personagens.forEach(pers => {
                const novoPers = document.createElement('div');
                novoPers.className = 'personagem-ficha';
                novoPers.id = `pers-${pers.id}`;
                
                novoPers.innerHTML = `
                    <h3>${pers.nome || 'Novo Personagem'} <button class="remove-btn" onclick="removerItem(${pers.id}, 'personagens')">X</button></h3>
                    
                    <label for="nome-${pers.id}">Nome Completo:</label>
                    <input type="text" id="nome-${pers.id}" value="${pers.nome || ''}" onchange="atualizarPersonagem(${pers.id}, 'nome', this.value)">

                    <label for="motivacao-${pers.id}">Motiva√ß√£o Principal:</label>
                    <input type="text" id="motivacao-${pers.id}" value="${pers.motivacao || ''}" onchange="atualizarPersonagem(${pers.id}, 'motivacao', this.value)">

                    <label for="arco-${pers.id}">Arco de Mudan√ßa (De/Para):</label>
                    <textarea id="arco-${pers.id}" rows="3" onchange="atualizarPersonagem(${pers.id}, 'arco', this.value)">${pers.arco || ''}</textarea>
                `;
                list.appendChild(novoPers);
            });
        }

        function adicionarPersonagem() {
            const novoPers = { 
                id: Date.now(), 
                nome: `Novo Personagem ${personagens.length + 1}`, 
                motivacao: '', 
                arco: '' 
            };
            personagens.push(novoPers);
            renderizarPersonagens();
            salvarDados();
        }

        function atualizarPersonagem(id, campo, valor) {
            const persIndex = personagens.findIndex(p => p.id === id);
            if (persIndex !== -1) {
                personagens[persIndex][campo] = valor;
                // Atualiza o t√≠tulo na tela (caso o campo 'nome' mude)
                if (campo === 'nome') {
                    document.querySelector(`#pers-${id} h3`).innerHTML = `${valor} <button class="remove-btn" onclick="removerItem(${id}, 'personagens')">X</button>`;
                }
                salvarDados();
            }
        }

        // --- FUN√á√ÉO DE REMO√á√ÉO GERAL ---

        function removerItem(id, tipo) {
            if (!confirm("Tem certeza que deseja remover este item?")) {
                return;
            }
            if (tipo === 'capitulos') {
                capitulos = capitulos.filter(c => c.id !== id);
                renderizarCapitulos();
            } else if (tipo === 'personagens') {
                personagens = personagens.filter(p => p.id !== id);
                renderizarPersonagens();
            }
            salvarDados();
        }

        // --- L√ìGICA DE ABAS (Mantida do Exemplo Anterior) ---
        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tab-button");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }

        // Garante que a primeira aba de "Guias" esteja ativa ao carregar
        document.addEventListener('DOMContentLoaded', () => {
            const firstButton = document.querySelector('.tab-button');
            if (firstButton) {
                openTab({ currentTarget: firstButton }, 'Guias');
            }
        });

    </script>
</body>
</html>
